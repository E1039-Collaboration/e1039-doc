<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>SeaQuest Offline Software: /home/yuhw/GitHub/SeaQuest/seaquest-offline/simulation/g4detectors/PHG4SiliconTrackerSteppingAction.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" /> 
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="../../index.html"><img
								alt="Logo" src="../../SeaQuest.png" /></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								SeaQuest Offline Software
							</div> 
							<div id="projectbrief">
								<!--Documentation for <a href="https://github.com/HaiwangYu/seaquest-offline">SeaQuest Offline Software</a>-->
								Documentation for SeaQuest Offline Software
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/dda/PHG4SiliconTrackerSteppingAction_8cc_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PHG4SiliconTrackerSteppingAction.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h.html">PHG4SiliconTrackerSteppingAction.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/da8/PHG4Parameters_8h.html">PHG4Parameters.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d60/PHG4ParametersContainer_8h.html">PHG4ParametersContainer.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d7f/PHG4SiliconTrackerDetector_8h.html">PHG4SiliconTrackerDetector.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/df9/PHG4StepStatusDecode_8h.html">PHG4StepStatusDecode.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../de/d83/PHG4Hit_8h.html">g4main/PHG4Hit.h</a>&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d3/d08/PHG4HitContainer_8h.html">g4main/PHG4HitContainer.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../db/d2b/PHG4Hitv1_8h.html">g4main/PHG4Hitv1.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d1/dc0/PHG4Shower_8h.html">g4main/PHG4Shower.h</a>&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../df/d1a/PHG4TrackUserInfoV1_8h.html">g4main/PHG4TrackUserInfoV1.h</a>&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../dd/dd4/getClass_8h.html">phool/getClass.h</a>&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;TSystem.h&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;Geant4/G4Step.hh&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;Geant4/G4ThreeVector.hh&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;Geant4/G4TouchableHandle.hh&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;Geant4/G4TouchableHistory.hh&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;boost/format.hpp&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;boost/tokenizer.hpp&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// this is an ugly hack, the gcc optimizer has a bug which</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// triggers the uninitialized variable warning which</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// stops compilation because of our -Werror</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;boost/version.hpp&gt;</span>  <span class="comment">// to get BOOST_VERSION</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#if (__GNUC__ == 4 &amp;&amp; __GNUC_MINOR__ == 4 &amp;&amp; BOOST_VERSION == 105700)</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#pragma GCC diagnostic ignored &quot;-Wuninitialized&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#pragma message &quot;ignoring bogus gcc warning in boost header lexical_cast.hpp&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;boost/lexical_cast.hpp&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#pragma GCC diagnostic warning &quot;-Wuninitialized&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;boost/lexical_cast.hpp&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_math.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//____________________________________________________________________________..</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a2a1431c79ed1c9f72508001fa03e5f86">   46</a></span>&#160;<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a2a1431c79ed1c9f72508001fa03e5f86">PHG4SiliconTrackerSteppingAction::PHG4SiliconTrackerSteppingAction</a>(<a class="code" href="../../dd/d34/classPHG4SiliconTrackerDetector.html">PHG4SiliconTrackerDetector</a>* detector, <span class="keyword">const</span> <a class="code" href="../../d5/d5f/classPHG4ParametersContainer.html">PHG4ParametersContainer</a>* parameters)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  : detector_(detector)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  , hits_(nullptr)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  , absorberhits_(nullptr)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  , hit(nullptr)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  , savehitcontainer(nullptr)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  , saveshower(nullptr)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  , paramscontainer(parameters)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="../../d5/d5f/classPHG4ParametersContainer.html#a6973acac6fe3b7d6ffaa7afe9d6c53c3">PHG4ParametersContainer::ConstRange</a> begin_end = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a33cbebecdd991d3f2ea99f785712585d">paramscontainer</a>-&gt;<a class="code" href="../../d5/d5f/classPHG4ParametersContainer.html#a4d18fc32b0c51ab126d9b10889d885db">GetAllParameters</a>();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d5/d5f/classPHG4ParametersContainer.html#a0193e389b57a081bff37969612571f1b">PHG4ParametersContainer::ConstIterator</a> iter = begin_end.first; iter != begin_end.second; ++iter)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../da/d29/classPHG4Parameters.html">PHG4Parameters</a>* par = iter-&gt;second;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a304ef224802ddf9e7ce2e6255e4e49de">IsActive</a>[iter-&gt;first] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">get_int_param</a>(<span class="stringliteral">&quot;active&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9ba2e371a3dc60dc8ff6f365e22d787e">IsBlackHole</a>[iter-&gt;first] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">get_int_param</a>(<span class="stringliteral">&quot;blackhole&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">strip_y</a>[iter-&gt;first] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#a4f94dc80ba894dc3eac307652f3a7e60">get_double_param</a>(<span class="stringliteral">&quot;strip_y&quot;</span>) * cm;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[iter-&gt;first][0] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#a4f94dc80ba894dc3eac307652f3a7e60">get_double_param</a>(<span class="stringliteral">&quot;strip_z_0&quot;</span>) * cm;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[iter-&gt;first][1] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#a4f94dc80ba894dc3eac307652f3a7e60">get_double_param</a>(<span class="stringliteral">&quot;strip_z_1&quot;</span>) * cm;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">nstrips_z_sensor</a>[iter-&gt;first][0] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">get_int_param</a>(<span class="stringliteral">&quot;nstrips_z_sensor_0&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">nstrips_z_sensor</a>[iter-&gt;first][1] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">get_int_param</a>(<span class="stringliteral">&quot;nstrips_z_sensor_1&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a78ab0be86e7135aa7eaee8f101bfdf33">nstrips_phi_cell</a>[iter-&gt;first] = par-&gt;<a class="code" href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">get_int_param</a>(<span class="stringliteral">&quot;nstrips_phi_cell&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;ladder&quot;</span>] = -1;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;stave&quot;</span>] = -2;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;pgs&quot;</span>] = -3;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;siinactive&quot;</span>] = -4;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;hdi&quot;</span>] = -5;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;fphxcontainer&quot;</span>] = -6;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;fphxcontainerm&quot;</span>] = -7;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;fphxcontainerp&quot;</span>] = -8;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;ladderext&quot;</span>] = -9;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;hdiext&quot;</span>] = -10;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[<span class="stringliteral">&quot;staveext&quot;</span>] = -11;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#af9dee22834fd99b364dc8df7bcc18cfb">   81</a></span>&#160;<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#af9dee22834fd99b364dc8df7bcc18cfb">PHG4SiliconTrackerSteppingAction::~PHG4SiliconTrackerSteppingAction</a>()</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// if the last hit was a zero energie deposit hit, it is just reset</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// and the memory is still allocated, so we need to delete it here</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// if the last hit was saved, hit is a nullptr pointer which are</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// legal to delete (it results in a no operation)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keyword">delete</span> <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  BOOST_FOREACH (<span class="keywordtype">string</span> absname, <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae7f6874abfc47dbfade3d158bfc0e111">missingabsorbers</a>)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;PHG4SiliconTrackerSteppingAction: need to implement absorber &quot;</span> &lt;&lt; absname &lt;&lt; endl;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//____________________________________________________________________________..</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#aaf323a2e5c061f5b23e88edf7fcf2bb7">   95</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#aaf323a2e5c061f5b23e88edf7fcf2bb7">PHG4SiliconTrackerSteppingAction::UserSteppingAction</a>(<span class="keyword">const</span> G4Step* aStep, <span class="keywordtype">bool</span>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  G4TouchableHandle touch = aStep-&gt;GetPreStepPoint()-&gt;GetTouchableHandle();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// get volume of the current step</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  G4VPhysicalVolume* volume = touch-&gt;GetVolume();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">const</span> G4Track* aTrack = aStep-&gt;GetTrack();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  G4StepPoint* prePoint = aStep-&gt;GetPreStepPoint();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  G4StepPoint* postPoint = aStep-&gt;GetPostStepPoint();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> whichactive = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9e5eb2d118770d0838c6dc49ef8e1a7c">detector_</a>-&gt;<a class="code" href="../../dd/d34/classPHG4SiliconTrackerDetector.html#a24cbf9b02cb6e7b73d8ab9ddb10f780a">IsInSiliconTracker</a>(volume);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (!whichactive)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// set ladder index</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> sphxlayer = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> inttlayer = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">int</span> ladderz = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> ladderphi = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> strip_z_index = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> strip_y_index = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (whichactive &gt; 0)  <span class="comment">// silicon acrive sensor</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      cout &lt;&lt; endl</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;PHG4SilicoTrackerSteppingAction::UserSteppingAction for volume name (pre) &quot;</span> &lt;&lt; touch-&gt;GetVolume()-&gt;GetName()</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; volume name (2) &quot;</span> &lt;&lt; touch-&gt;GetVolume(2)-&gt;GetName()</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; volume-&gt;GetTranslation &quot;</span> &lt;&lt; touch-&gt;GetVolume()-&gt;GetTranslation()</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; volume-&gt;GetCopyNo() &quot;</span> &lt;&lt; volume-&gt;GetCopyNo()</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;           &lt;&lt; endl;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Get the layer and ladder information</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// thi is the same for all strips in the sensor</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    boost::char_separator&lt;char&gt; sep(<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt; tok(touch-&gt;GetVolume(2)-&gt;GetName(), sep);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt;::const_iterator tokeniter;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    tokeniter = tok.begin();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (*tokeniter == <span class="stringliteral">&quot;ladder&quot;</span>)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="comment">// advance the tokeniter and then cast it if first token is &quot;ladder&quot;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      sphxlayer = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      inttlayer = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      ladderz = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      ladderphi = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      cout &lt;&lt; <a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a88ff50956245a2b72d459bad2004e1ca">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;parsing of &quot;</span> &lt;&lt; touch-&gt;GetVolume(2)-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; failed, it does not start with ladder_&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      exit(1);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (inttlayer &lt; 0 || inttlayer &gt;= 4)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      assert(!<span class="stringliteral">&quot;PHG4SiliconTrackerSteppingAction: check INTT ladder layer.&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    map&lt;int, int&gt;::const_iterator activeiter = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a304ef224802ddf9e7ce2e6255e4e49de">IsActive</a>.find(inttlayer);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (activeiter == <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a304ef224802ddf9e7ce2e6255e4e49de">IsActive</a>.end())</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;PHG4SiliconTrackerSteppingAction: could not find active flag for layer &quot;</span> &lt;&lt; inttlayer &lt;&lt; endl;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      gSystem-&gt;Exit(1);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (activeiter-&gt;second == 0)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// convert ladder type [0-3] to silicon sensor type [0-1]</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> laddertype = (ladderz == 1 || ladderz == 2) ? 0 : 1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Find the strip y and z index values from the copy number (integer division, quotient is strip_y, remainder is strip_z)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    div_t copydiv = div(volume-&gt;GetCopyNo(), <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">nstrips_z_sensor</a>[inttlayer][laddertype]);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    strip_y_index = copydiv.quot;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    strip_z_index = copydiv.rem;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    G4ThreeVector strip_pos = volume-&gt;GetTranslation();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    G4ThreeVector prepos = prePoint-&gt;GetPosition();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    G4ThreeVector postpos = postPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; sphxlayer &quot;</span> &lt;&lt; sphxlayer &lt;&lt; <span class="stringliteral">&quot; ladderz &quot;</span> &lt;&lt; ladderz &lt;&lt; <span class="stringliteral">&quot; ladderphi &quot;</span> &lt;&lt; ladderphi </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; copy no. &quot;</span> &lt;&lt;  volume-&gt;GetCopyNo() &lt;&lt; <span class="stringliteral">&quot; nstrips_z_sensor &quot;</span> &lt;&lt;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">nstrips_z_sensor</a>[inttlayer][laddertype] </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; strip_y_index &quot;</span> &lt;&lt; strip_y_index &lt;&lt; <span class="stringliteral">&quot; strip_z_index &quot;</span> &lt;&lt; strip_z_index &lt;&lt; endl;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// There are two failure modes observed for this stupid parameterised volume:</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">//  1) If the prePoint step status is &quot;fUndefined&quot; then the copy number is sometimes kept from the last hit, which is often an unrelated volume</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">//  2) If the  pre and post step are in the same volume but they both have status fGeomBoundary, the volume is assigned the copy number of the next volume, which is usually off by one in strip_y_index</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// in both cases we need to find the correct strip_y_index and strip_z_index values the hard way - that is what is done here</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">int</span> fixit = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> ( prePoint-&gt;GetStepStatus() == fGeomBoundary &amp;&amp; postPoint-&gt;GetStepStatus() == fGeomBoundary)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      G4VPhysicalVolume* volume_post = postPoint-&gt;GetTouchableHandle()-&gt;GetVolume();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      G4LogicalVolume* logvolpre = volume-&gt;GetLogicalVolume();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      G4LogicalVolume* logvolpost = volume_post-&gt;GetLogicalVolume();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// this is just failsafe - we still have those impossible hits where pre and poststep</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// are in the same volume with status fGeomBoundary</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// but the extraction of the strip index above works for those</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// my assumption is that the end of a physics step coincides with the boundary and</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// the physics step size is taken rather the geometric step size</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">if</span> (logvolpre == logvolpost)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (volume-&gt;GetCopyNo() == volume_post-&gt;GetCopyNo() ||  prePoint-&gt;GetStepStatus() == fUndefined)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          fixit = 1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> ( prePoint-&gt;GetStepStatus() == fUndefined)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      fixit = 2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>( fixit )</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordtype">int</span> strip_y_index_old = strip_y_index;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordtype">int</span> strip_z_index_old = strip_z_index;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// we need a hack to compare the values above with the correct strip index values</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// the transform of the world coordinates into the sensor frame will work correctly,</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// so we determine the strip indices from the hit position</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        G4ThreeVector preworldPos = prePoint-&gt;GetPosition();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        G4ThreeVector strip_pos = touch-&gt;GetHistory()-&gt;GetTransform(touch-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(preworldPos);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        G4ThreeVector postworldPos = postPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        G4ThreeVector poststrip_pos = touch-&gt;GetHistory()-&gt;GetTransform(touch-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(postworldPos);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        strip_z_index = 0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">nstrips_z_sensor</a>[inttlayer][laddertype]; ++i)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> zmin = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[inttlayer][laddertype] * (double) (i) -<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[inttlayer][laddertype] / 2. * (double) nstrips_z_sensor[inttlayer][laddertype];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> zmax = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[inttlayer][laddertype] * (double) (i + 1) - <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">strip_z</a>[inttlayer][laddertype] / 2. * (double) nstrips_z_sensor[inttlayer][laddertype];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordflow">if</span> (strip_pos.z() / mm &gt; zmin &amp;&amp; strip_pos.z() / mm &lt;= zmax)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;              {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                strip_z_index = i;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1) std::cout &lt;&lt; <span class="stringliteral">&quot;                            revised strip z position = &quot;</span> &lt;&lt; strip_z_index &lt;&lt; std::endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        strip_y_index = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2 * <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a78ab0be86e7135aa7eaee8f101bfdf33">nstrips_phi_cell</a>[inttlayer]; ++i)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> ymin = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">strip_y</a>[inttlayer] * (double) (i) -<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">strip_y</a>[inttlayer] * (double) nstrips_phi_cell[inttlayer];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> ymax = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">strip_y</a>[inttlayer] * (double) (i + 1) - <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">strip_y</a>[inttlayer] * (double) nstrips_phi_cell[inttlayer];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (strip_pos.y() / mm &gt; ymin &amp;&amp; strip_pos.y() / mm &lt;= ymax)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                strip_y_index = i;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1) std::cout &lt;&lt; <span class="stringliteral">&quot;                            revised strip y position = &quot;</span> &lt;&lt; strip_y_index &lt;&lt; std::endl;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;              }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span>(fixit == 1)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (strip_y_index_old != strip_y_index || strip_z_index_old != strip_z_index)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                G4VPhysicalVolume* volume_post = postPoint-&gt;GetTouchableHandle()-&gt;GetVolume();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                G4LogicalVolume* logvolpre = volume-&gt;GetLogicalVolume();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                G4LogicalVolume* logvolpost = volume_post-&gt;GetLogicalVolume();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                G4ThreeVector preworldPos = prePoint-&gt;GetPosition();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                G4ThreeVector strip_pos = touch-&gt;GetHistory()-&gt;GetTransform(touch-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(preworldPos);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                G4ThreeVector postworldPos = postPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                G4ThreeVector poststrip_pos = touch-&gt;GetHistory()-&gt;GetTransform(touch-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(postworldPos);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;Overlap detected in volume &quot;</span> &lt;&lt; volume-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; where post volume &quot;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                     &lt;&lt; volume_post-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; has same copy no.&quot;</span> &lt;&lt; volume-&gt;GetCopyNo()</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; pre and post step point of same volume for step status fGeomBoundary&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;logvol name &quot;</span> &lt;&lt; logvolpre-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot;, post: &quot;</span> &lt;&lt; logvolpost-&gt;GetName() &lt;&lt; endl;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;strip y bef: &quot;</span> &lt;&lt; strip_y_index_old &lt;&lt; <span class="stringliteral">&quot;, strip z: &quot;</span> &lt;&lt; strip_z_index_old &lt;&lt; endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot; strip y aft: &quot;</span> &lt;&lt; strip_y_index &lt;&lt; <span class="stringliteral">&quot;, strip z: &quot;</span> &lt;&lt; strip_z_index &lt;&lt; endl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;pre hitpos x: &quot;</span> &lt;&lt; strip_pos.x() &lt;&lt; <span class="stringliteral">&quot;, y: &quot;</span> &lt;&lt; strip_pos.y() &lt;&lt; <span class="stringliteral">&quot;, z: &quot;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                     &lt;&lt; strip_pos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;posthitpos x: &quot;</span> &lt;&lt; poststrip_pos.x() &lt;&lt; <span class="stringliteral">&quot;, y: &quot;</span> &lt;&lt; poststrip_pos.y() &lt;&lt; <span class="stringliteral">&quot;, z: &quot;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                     &lt;&lt; poststrip_pos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;eloss: &quot;</span> &lt;&lt; aStep-&gt;GetTotalEnergyDeposit() / GeV &lt;&lt; <span class="stringliteral">&quot; GeV&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;safety prestep: &quot;</span> &lt;&lt; prePoint-&gt;GetSafety()</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;, poststep: &quot;</span> &lt;&lt; postPoint-&gt;GetSafety() &lt;&lt; endl;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1) cout &lt;&lt; <span class="stringliteral">&quot;Detected fUndefined for prePoint step status, re-calculated strip_z_index and strip_y_index independently above&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      } </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  } <span class="comment">// end of whichactive &gt; 0 block</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">else</span>  <span class="comment">// silicon inactive area, FPHX, stabe etc. as absorbers</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     <span class="keywordflow">try</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;       {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          boost::char_separator&lt;char&gt; sep(<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt; tok(touch-&gt;GetVolume(0)-&gt;GetName(), sep);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt;::const_iterator tokeniter;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          tokeniter = tok.begin();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          map&lt;string, int&gt;::const_iterator iter = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>.find(*tokeniter);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keywordflow">if</span> (iter == <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>.end())</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Absorber &quot;</span> &lt;&lt; *tokeniter &lt;&lt; <span class="stringliteral">&quot; not in list&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;              <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae7f6874abfc47dbfade3d158bfc0e111">missingabsorbers</a>.insert(*tokeniter);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;              ladderz = -<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>.size();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">AbsorberIndex</a>[*tokeniter] = ladderz;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;              ladderz = iter-&gt;second;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          sphxlayer = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          inttlayer = boost::lexical_cast&lt;<span class="keywordtype">int</span>&gt;(*(++tokeniter));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;       }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     <span class="keywordflow">catch</span> (...)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;       {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot; that did not work for &quot;</span> &lt;&lt; touch-&gt;GetVolume(0)-&gt;GetName() &lt;&lt; endl;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae7f6874abfc47dbfade3d158bfc0e111">missingabsorbers</a>.insert(touch-&gt;GetVolume(0)-&gt;GetName());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;       }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    } <span class="comment">// end of si inactive area block</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// collect energy and track length step by step</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  G4double edep = aStep-&gt;GetTotalEnergyDeposit() / GeV;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  G4double eion = (aStep-&gt;GetTotalEnergyDeposit() - aStep-&gt;GetNonIonizingEnergyDeposit()) / GeV;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// if this block stops everything, just put all kinetic energy into edep</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9ba2e371a3dc60dc8ff6f365e22d787e">IsBlackHole</a>.find(inttlayer))-&gt;second == 1)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    edep = aTrack-&gt;GetKineticEnergy() / GeV;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    G4Track* killtrack = <span class="keyword">const_cast&lt;</span>G4Track*<span class="keyword">&gt;</span>(aTrack);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    killtrack-&gt;SetTrackStatus(fStopAndKill);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">bool</span> geantino = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// the check for the pdg code speeds things up, I do not want to make</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// an expensive string compare for every track when we know</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// geantino or chargedgeantino has pid=0</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (aTrack-&gt;GetParticleDefinition()-&gt;GetPDGEncoding() == 0 &amp;&amp; aTrack-&gt;GetParticleDefinition()-&gt;GetParticleName().find(<span class="stringliteral">&quot;geantino&quot;</span>) != string::npos)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    geantino = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;prePoint step status = &quot;</span> &lt;&lt; prePoint-&gt;GetStepStatus() &lt;&lt; <span class="stringliteral">&quot; postPoint step status = &quot;</span> &lt;&lt; postPoint-&gt;GetStepStatus() &lt;&lt; endl;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">switch</span> (prePoint-&gt;GetStepStatus())</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">case</span> fGeomBoundary:</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">case</span> fUndefined:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1) cout &lt;&lt; <span class="stringliteral">&quot; found prePoint step status of fGeomBoundary or fUndefined, start a new hit &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// if previous hit was saved, hit pointer was set to nullptr</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// and we have to make a new one</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a> = <span class="keyword">new</span> <a class="code" href="../../d9/d35/classPHG4Hitv1.html">PHG4Hitv1</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a164f860f2c74482d5d26c220f19be1f1">set_layer</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) sphxlayer);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// set the index values needed to locate the sensor strip</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a3d81557a99487497dde1e254ac654f58">set_ladder_z_index</a>(ladderz);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (whichactive &gt; 0)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a762aa9813238c4beb27178f73a7b864a">set_strip_z_index</a>(strip_z_index);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a1eb73c0ad886e786061215db483f8dae">set_strip_y_index</a>(strip_y_index);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a2db3114a7269082d3f6a074ab3a36666">set_ladder_phi_index</a>(ladderphi);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//here we set the entrance values in cm</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#aa91398b4546e9d099443217e1577f79b">set_x</a>(0, prePoint-&gt;GetPosition().x() / cm);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a3ab7971f354374b005f9a11fd761b53e">set_y</a>(0, prePoint-&gt;GetPosition().y() / cm);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a896d7a45139f9cbc2e429127baa61715">set_z</a>(0, prePoint-&gt;GetPosition().z() / cm);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5454f2609bd0574d3beebff27c598c1d">set_px</a>(0, prePoint-&gt;GetMomentum().x() / GeV);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5c93815f1d3921153ac87c5ff0c8439d">set_py</a>(0, prePoint-&gt;GetMomentum().y() / GeV);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5fe95d18c4dbfee43494b9b926d1df02">set_pz</a>(0, prePoint-&gt;GetMomentum().z() / GeV);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// time in ns</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5cced855d1a85cb380f993417f1e5b1a">set_t</a>(0, prePoint-&gt;GetGlobalTime() / nanosecond);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">//set the track ID</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ac4e7f18a0d54ec275128651928e69531">set_trkid</a>(aTrack-&gt;GetTrackID());</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//set the initial energy deposit</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ad97bbe7fcf81822a93654afe0e540143">set_edep</a>(0);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a65d6d5bfd2a9e6fe2392fc57ac6c57d0">set_eion</a>(0);  <span class="comment">// only implemented for v5 otherwise empty</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (whichactive &gt; 0)  <span class="comment">// return of IsInSiliconTracker, &gt; 0 hit in si-strip, &lt; 0 hit in absorber</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// Now save the container we want to add this hit to</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a3a103b9cc928011c79a771379b39d1a3">savehitcontainer</a> = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#adfae06523de2947b6b103c92fc779c75">hits_</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a3a103b9cc928011c79a771379b39d1a3">savehitcontainer</a> = <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4eb4685a2f5238d32d29bfcfd4ab8acb">absorberhits_</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (G4VUserTrackInformation* p = aTrack-&gt;GetUserInformation())</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/da8/classPHG4TrackUserInfoV1.html">PHG4TrackUserInfoV1</a>* pp = dynamic_cast&lt;PHG4TrackUserInfoV1*&gt;(p))</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ac4e7f18a0d54ec275128651928e69531">set_trkid</a>(pp-&gt;GetUserTrackId());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a3bd1d01f13031802bc9956609c416a46">set_shower_id</a>(pp-&gt;GetShower()-&gt;get_id());</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#afc148f1d3758eb5277136f87f189fe72">saveshower</a> = pp-&gt;GetShower();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// here we just update the exit values, it will be overwritten</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// for every step until we leave the volume or the particle</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// ceases to exist</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#aa91398b4546e9d099443217e1577f79b">set_x</a>(1, postPoint-&gt;GetPosition().x() / cm);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a3ab7971f354374b005f9a11fd761b53e">set_y</a>(1, postPoint-&gt;GetPosition().y() / cm);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a896d7a45139f9cbc2e429127baa61715">set_z</a>(1, postPoint-&gt;GetPosition().z() / cm);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5454f2609bd0574d3beebff27c598c1d">set_px</a>(1, postPoint-&gt;GetMomentum().x() / GeV);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5c93815f1d3921153ac87c5ff0c8439d">set_py</a>(1, postPoint-&gt;GetMomentum().y() / GeV);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5fe95d18c4dbfee43494b9b926d1df02">set_pz</a>(1, postPoint-&gt;GetMomentum().z() / GeV);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a5cced855d1a85cb380f993417f1e5b1a">set_t</a>(1, postPoint-&gt;GetGlobalTime() / nanosecond);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">//sum up the energy to get total deposited</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ad97bbe7fcf81822a93654afe0e540143">set_edep</a>(<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a299edb9d0b140d0456f8bfecdf9cac56">get_edep</a>() + edep);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a65d6d5bfd2a9e6fe2392fc57ac6c57d0">set_eion</a>(<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ab8db2cb7bc978a58777600b2bd7a22ac">get_eion</a>() + eion);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span> (geantino)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#ad97bbe7fcf81822a93654afe0e540143">set_edep</a>(-1);  <span class="comment">// only energy=0 g4hits get dropped, this way geantinos survive the g4hit compression</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a65d6d5bfd2a9e6fe2392fc57ac6c57d0">set_eion</a>(-1);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (edep &gt; 0)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (G4VUserTrackInformation* p = aTrack-&gt;GetUserInformation())</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/da8/classPHG4TrackUserInfoV1.html">PHG4TrackUserInfoV1</a>* pp = dynamic_cast&lt;PHG4TrackUserInfoV1*&gt;(p))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        pp-&gt;SetKeep(1);  <span class="comment">// we want to keep the track</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// if any of these conditions is true this is the last step in</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// this volume and we need to save the hit</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// postPoint-&gt;GetStepStatus() == fGeomBoundary: track leaves this volume</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// postPoint-&gt;GetStepStatus() == fWorldBoundary: track leaves this world</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// (happens when your detector goes outside world volume)</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// postPoint-&gt;GetStepStatus() == fAtRestDoItProc: track stops (typically</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// aTrack-&gt;GetTrackStatus() == fStopAndKill is also set)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// aTrack-&gt;GetTrackStatus() == fStopAndKill: track ends</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">if</span> (postPoint-&gt;GetStepStatus() == fGeomBoundary ||</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      postPoint-&gt;GetStepStatus() == fWorldBoundary ||</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      postPoint-&gt;GetStepStatus() == fAtRestDoItProc ||</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      aTrack-&gt;GetTrackStatus() == fStopAndKill)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot; postPoint step status changed to &quot;</span> &lt;&lt; postPoint-&gt;GetStepStatus() &lt;&lt; <span class="stringliteral">&quot; save hit and delete it&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        cout  &lt;&lt; <span class="stringliteral">&quot; fWorldBoundary &quot;</span> &lt;&lt; fWorldBoundary</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; fGeomBoundary = &quot;</span> &lt;&lt; fGeomBoundary</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; fAtRestDoItProc &quot;</span> &lt;&lt; fAtRestDoItProc</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; fAlongStepDoItProc &quot;</span> &lt;&lt; fAlongStepDoItProc</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; fPostStepDoItProc &quot;</span> &lt;&lt; fPostStepDoItProc</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; fUserDefinedLimit &quot;</span> &lt;&lt; fUserDefinedLimit</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; fExclusivelyForcedProc &quot;</span> &lt;&lt; fExclusivelyForcedProc</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; fUndefined &quot;</span> &lt;&lt; fUndefined</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; fStopAndKill &quot;</span> &lt;&lt; fStopAndKill</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;             &lt;&lt; endl;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// save only hits with energy deposit (or -1 for geantino)</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a299edb9d0b140d0456f8bfecdf9cac56">get_edep</a>())</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a3a103b9cc928011c79a771379b39d1a3">savehitcontainer</a>-&gt;<a class="code" href="../../d4/d30/classPHG4HitContainer.html#a4df3ca68ecff69c9d7976b84fcc82e93">AddHit</a>(sphxlayer, <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#afc148f1d3758eb5277136f87f189fe72">saveshower</a>)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#afc148f1d3758eb5277136f87f189fe72">saveshower</a>-&gt;<a class="code" href="../../db/d88/classPHG4Shower.html#aff36d66ca2bfafcb3528d98960fb89c4">add_g4hit_id</a>(<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a3a103b9cc928011c79a771379b39d1a3">savehitcontainer</a>-&gt;<a class="code" href="../../d4/d30/classPHG4HitContainer.html#a5073671e6d35969dc3d421e2278229af">GetID</a>(), <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#acea6b2f3763d899e4de3765b9b5c6e51">get_hit_id</a>());</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#acde0bddc67695b3afde72fbc86a5d02f">print</a>();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">// ownership has been transferred to container, set to null</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">// so we will create a new hit for the next track</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="comment">// if this hit has no energy deposit, just reset it for reuse</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="comment">// this means we have to delete it in the dtor. If this was</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="comment">// the last hit we processed the memory is still allocated</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">hit</a>-&gt;<a class="code" href="../../d3/d9e/classPHG4Hit.html#a73b21baa3e6de2ae4c8101ca5293a9ed">Reset</a>();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    G4StepPoint* prePoint = aStep-&gt;GetPreStepPoint();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    G4StepPoint* postPoint = aStep-&gt;GetPostStepPoint();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    G4ThreeVector preworldPos = prePoint-&gt;GetPosition();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    G4ThreeVector postworldPos = postPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; entry point world pos &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().x() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().y() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().z() &lt;&lt; endl;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; exit point world pos &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().x() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().y() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().z() &lt;&lt; endl;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// The exit point transforms do not work here because the particle has already entered the next volume</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// - go back and find Jin&#39;s fix for this</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// strip local pos</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    G4TouchableHistory* theTouchable = (G4TouchableHistory*) (prePoint-&gt;GetTouchable());</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    G4ThreeVector prelocalPos = theTouchable-&gt;GetHistory()-&gt;GetTopTransform().TransformPoint(preworldPos);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; entry point strip local pos: &quot;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; prelocalPos.x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; prelocalPos.y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; prelocalPos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    G4TouchableHistory* postTouchable = (G4TouchableHistory*) (postPoint-&gt;GetTouchable());</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    G4ThreeVector postlocalPos = postTouchable-&gt;GetHistory()-&gt;GetTopTransform().TransformPoint(postworldPos);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; exit point strip local pos: &quot;</span> &lt;&lt; postlocalPos.x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; postlocalPos.y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; postlocalPos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// sensor local pos</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    G4ThreeVector presensorLocalPos = theTouchable-&gt;GetHistory()-&gt;GetTransform(theTouchable-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(preworldPos);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; entry point sensor local pos: &quot;</span> &lt;&lt; presensorLocalPos.x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; presensorLocalPos.y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; presensorLocalPos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    G4ThreeVector postsensorLocalPos = postTouchable-&gt;GetHistory()-&gt;GetTransform(postTouchable-&gt;GetHistory()-&gt;GetDepth() - 1).TransformPoint(postworldPos);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; exit point sensor local pos: &quot;</span> &lt;&lt; postsensorLocalPos.x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; postsensorLocalPos.y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; postsensorLocalPos.z() &lt;&lt; endl;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">if</span> (whichactive &gt; 0 &amp;&amp; <a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 0)  <span class="comment">// return of IsInSiliconTracker, &gt; 0 hit in si-strip, &lt; 0 hit in absorber</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    G4StepPoint* prePoint = aStep-&gt;GetPreStepPoint();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    G4StepPoint* postPoint = aStep-&gt;GetPostStepPoint();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;----- PHg4SiliconTrackerSteppingAction::UserSteppingAction - active volume = &quot;</span> &lt;&lt; volume-&gt;GetName() &lt;&lt; endl;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       strip_z_index = &quot;</span> &lt;&lt; strip_z_index &lt;&lt; <span class="stringliteral">&quot; strip_y_index = &quot;</span> &lt;&lt; strip_y_index &lt;&lt; endl;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       prepoint x position &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().x() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       prepoint y position &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().y() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       prepoint z position &quot;</span> &lt;&lt; prePoint-&gt;GetPosition().z() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       postpoint x position &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().x() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       postpoint y position &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().y() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       postpoint z position &quot;</span> &lt;&lt; postPoint-&gt;GetPosition().z() / cm &lt;&lt; endl;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       edep &quot;</span> &lt;&lt; edep &lt;&lt; endl;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;       eion &quot;</span> &lt;&lt; eion &lt;&lt; endl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">//____________________________________________________________________________..</span></div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9b26e71b96abf59f46c1e4d3a7338cf2">  526</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9b26e71b96abf59f46c1e4d3a7338cf2">PHG4SiliconTrackerSteppingAction::SetInterfacePointers</a>(<a class="code" href="../../d5/dca/classPHCompositeNode.html">PHCompositeNode</a>* topNode)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> detectorname = (<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9e5eb2d118770d0838c6dc49ef8e1a7c">detector_</a>-&gt;<a class="code" href="../../dd/d34/classPHG4SiliconTrackerDetector.html#a5dad9b731175d64532b856bb396f8976">SuperDetector</a>() != <span class="stringliteral">&quot;NONE&quot;</span>) ? <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9e5eb2d118770d0838c6dc49ef8e1a7c">detector_</a>-&gt;<a class="code" href="../../dd/d34/classPHG4SiliconTrackerDetector.html#a5dad9b731175d64532b856bb396f8976">SuperDetector</a>() : <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9e5eb2d118770d0838c6dc49ef8e1a7c">detector_</a>-&gt;<a class="code" href="../../d3/de7/classPHG4Detector.html#a2d071f49fa045db5ade51bb99f88218f">GetName</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> hitnodename = <span class="stringliteral">&quot;G4HIT_&quot;</span> + detectorname;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> absorbernodename = <span class="stringliteral">&quot;G4HIT_ABSORBER_&quot;</span> + detectorname;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">//now look for the map and grab a pointer to it.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#adfae06523de2947b6b103c92fc779c75">hits_</a> = findNode::getClass&lt;PHG4HitContainer&gt;(topNode, hitnodename.c_str());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4eb4685a2f5238d32d29bfcfd4ab8acb">absorberhits_</a> = findNode::getClass&lt;PHG4HitContainer&gt;(topNode, absorbernodename.c_str());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// if we do not find the node it&#39;s messed up.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#adfae06523de2947b6b103c92fc779c75">hits_</a>)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;PHG4SiliconTrackerSteppingAction::SetTopNode - unable to find &quot;</span> &lt;&lt; hitnodename &lt;&lt; endl;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">if</span> (!absorberhits_ &amp;&amp; <a class="code" href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">verbosity</a> &gt; 1)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;PHG4SiliconTrackerSteppingAction::SetTopNode - unable to find &quot;</span> &lt;&lt; absorbernodename &lt;&lt; endl;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
<div class="ttc" id="classPHG4Hit_html_a3d81557a99487497dde1e254ac654f58"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a3d81557a99487497dde1e254ac654f58">PHG4Hit::set_ladder_z_index</a></div><div class="ttdeci">virtual void set_ladder_z_index(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00074">PHG4Hit.h:74</a></div></div>
<div class="ttc" id="classPHG4Hit_html_ac4e7f18a0d54ec275128651928e69531"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#ac4e7f18a0d54ec275128651928e69531">PHG4Hit::set_trkid</a></div><div class="ttdeci">virtual void set_trkid(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00071">PHG4Hit.h:71</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a3bd1d01f13031802bc9956609c416a46"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a3bd1d01f13031802bc9956609c416a46">PHG4Hit::set_shower_id</a></div><div class="ttdeci">virtual void set_shower_id(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00068">PHG4Hit.h:68</a></div></div>
<div class="ttc" id="PHG4SiliconTrackerDetector_8h_html"><div class="ttname"><a href="../../df/d7f/PHG4SiliconTrackerDetector_8h.html">PHG4SiliconTrackerDetector.h</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a26d144acf79b420fbb3ceddf5942fb49"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a26d144acf79b420fbb3ceddf5942fb49">PHG4SiliconTrackerSteppingAction::nstrips_z_sensor</a></div><div class="ttdeci">int nstrips_z_sensor[4][2]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00037">PHG4SiliconTrackerSteppingAction.h:37</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_ae9178b0c07a8b387fda7d4f73c21e5fe"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae9178b0c07a8b387fda7d4f73c21e5fe">PHG4SiliconTrackerSteppingAction::strip_y</a></div><div class="ttdeci">double strip_y[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00035">PHG4SiliconTrackerSteppingAction.h:35</a></div></div>
<div class="ttc" id="classPHG4ParametersContainer_html_a4d18fc32b0c51ab126d9b10889d885db"><div class="ttname"><a href="../../d5/d5f/classPHG4ParametersContainer.html#a4d18fc32b0c51ab126d9b10889d885db">PHG4ParametersContainer::GetAllParameters</a></div><div class="ttdeci">ConstRange GetAllParameters() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d60/PHG4ParametersContainer_8h_source.html#l00036">PHG4ParametersContainer.h:36</a></div></div>
<div class="ttc" id="classPHG4Parameters_html"><div class="ttname"><a href="../../da/d29/classPHG4Parameters.html">PHG4Parameters</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/da8/PHG4Parameters_8h_source.html#l00018">PHG4Parameters.h:18</a></div></div>
<div class="ttc" id="classPHG4Parameters_html_a4f94dc80ba894dc3eac307652f3a7e60"><div class="ttname"><a href="../../da/d29/classPHG4Parameters.html#a4f94dc80ba894dc3eac307652f3a7e60">PHG4Parameters::get_double_param</a></div><div class="ttdeci">double get_double_param(const std::string &amp;name) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dab/PHG4Parameters_8cc_source.html#l00101">PHG4Parameters.cc:101</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a2db3114a7269082d3f6a074ab3a36666"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a2db3114a7269082d3f6a074ab3a36666">PHG4Hit::set_ladder_phi_index</a></div><div class="ttdeci">virtual void set_ladder_phi_index(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00075">PHG4Hit.h:75</a></div></div>
<div class="ttc" id="PHG4TrackUserInfoV1_8h_html"><div class="ttname"><a href="../../df/d1a/PHG4TrackUserInfoV1_8h.html">PHG4TrackUserInfoV1.h</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a8e3ac076ab5654f155bbf3978ce74ea4"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a8e3ac076ab5654f155bbf3978ce74ea4">PHG4SiliconTrackerSteppingAction::AbsorberIndex</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; AbsorberIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00041">PHG4SiliconTrackerSteppingAction.h:41</a></div></div>
<div class="ttc" id="classPHG4SteppingAction_html_a7bb830d99275c662f0b9ab1322badb6e"><div class="ttname"><a href="../../df/d3f/classPHG4SteppingAction.html#a7bb830d99275c662f0b9ab1322badb6e">PHG4SteppingAction::verbosity</a></div><div class="ttdeci">int verbosity</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d55/PHG4SteppingAction_8h_source.html#l00055">PHG4SteppingAction.h:55</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a1eb73c0ad886e786061215db483f8dae"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a1eb73c0ad886e786061215db483f8dae">PHG4Hit::set_strip_y_index</a></div><div class="ttdeci">virtual void set_strip_y_index(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00073">PHG4Hit.h:73</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a9b26e71b96abf59f46c1e4d3a7338cf2"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9b26e71b96abf59f46c1e4d3a7338cf2">PHG4SiliconTrackerSteppingAction::SetInterfacePointers</a></div><div class="ttdeci">virtual void SetInterfacePointers(PHCompositeNode *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc_source.html#l00526">PHG4SiliconTrackerSteppingAction.cc:526</a></div></div>
<div class="ttc" id="classPHG4TrackUserInfoV1_html"><div class="ttname"><a href="../../da/da8/classPHG4TrackUserInfoV1.html">PHG4TrackUserInfoV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1a/PHG4TrackUserInfoV1_8h_source.html#l00015">PHG4TrackUserInfoV1.h:15</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a5cced855d1a85cb380f993417f1e5b1a"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a5cced855d1a85cb380f993417f1e5b1a">PHG4Hit::set_t</a></div><div class="ttdeci">virtual void set_t(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00061">PHG4Hit.h:61</a></div></div>
<div class="ttc" id="classPHG4ParametersContainer_html_a0193e389b57a081bff37969612571f1b"><div class="ttname"><a href="../../d5/d5f/classPHG4ParametersContainer.html#a0193e389b57a081bff37969612571f1b">PHG4ParametersContainer::ConstIterator</a></div><div class="ttdeci">Map::const_iterator ConstIterator</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d60/PHG4ParametersContainer_8h_source.html#l00020">PHG4ParametersContainer.h:20</a></div></div>
<div class="ttc" id="PHG4Parameters_8h_html"><div class="ttname"><a href="../../df/da8/PHG4Parameters_8h.html">PHG4Parameters.h</a></div></div>
<div class="ttc" id="classPHG4HitContainer_html_a5073671e6d35969dc3d421e2278229af"><div class="ttname"><a href="../../d4/d30/classPHG4HitContainer.html#a5073671e6d35969dc3d421e2278229af">PHG4HitContainer::GetID</a></div><div class="ttdeci">int GetID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/PHG4HitContainer_8h_source.html#l00034">PHG4HitContainer.h:34</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a73b21baa3e6de2ae4c8101ca5293a9ed"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a73b21baa3e6de2ae4c8101ca5293a9ed">PHG4Hit::Reset</a></div><div class="ttdeci">virtual void Reset()</div><div class="ttdoc">Clear Event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/PHG4Hit_8cc_source.html#l00063">PHG4Hit.cc:63</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_adfae06523de2947b6b103c92fc779c75"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#adfae06523de2947b6b103c92fc779c75">PHG4SiliconTrackerSteppingAction::hits_</a></div><div class="ttdeci">PHG4HitContainer * hits_</div><div class="ttdoc">pointer to hit container </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00028">PHG4SiliconTrackerSteppingAction.h:28</a></div></div>
<div class="ttc" id="classPHG4Hit_html_acea6b2f3763d899e4de3765b9b5c6e51"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#acea6b2f3763d899e4de3765b9b5c6e51">PHG4Hit::get_hit_id</a></div><div class="ttdeci">virtual PHG4HitDefs::keytype get_hit_id() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00036">PHG4Hit.h:36</a></div></div>
<div class="ttc" id="PHG4Hitv1_8h_html"><div class="ttname"><a href="../../db/d2b/PHG4Hitv1_8h.html">PHG4Hitv1.h</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_aaf323a2e5c061f5b23e88edf7fcf2bb7"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#aaf323a2e5c061f5b23e88edf7fcf2bb7">PHG4SiliconTrackerSteppingAction::UserSteppingAction</a></div><div class="ttdeci">virtual bool UserSteppingAction(const G4Step *, bool)</div><div class="ttdoc">stepping action. This defines processing of a single step in a given volume </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc_source.html#l00095">PHG4SiliconTrackerSteppingAction.cc:95</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a2a1431c79ed1c9f72508001fa03e5f86"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a2a1431c79ed1c9f72508001fa03e5f86">PHG4SiliconTrackerSteppingAction::PHG4SiliconTrackerSteppingAction</a></div><div class="ttdeci">PHG4SiliconTrackerSteppingAction(PHG4SiliconTrackerDetector *, const PHG4ParametersContainer *parameters)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc_source.html#l00046">PHG4SiliconTrackerSteppingAction.cc:46</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a33cbebecdd991d3f2ea99f785712585d"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a33cbebecdd991d3f2ea99f785712585d">PHG4SiliconTrackerSteppingAction::paramscontainer</a></div><div class="ttdeci">const PHG4ParametersContainer * paramscontainer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00033">PHG4SiliconTrackerSteppingAction.h:33</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a5454f2609bd0574d3beebff27c598c1d"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a5454f2609bd0574d3beebff27c598c1d">PHG4Hit::set_px</a></div><div class="ttdeci">virtual void set_px(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00055">PHG4Hit.h:55</a></div></div>
<div class="ttc" id="classPHG4Parameters_html_aba1875d639dad6de2154906124014673"><div class="ttname"><a href="../../da/d29/classPHG4Parameters.html#aba1875d639dad6de2154906124014673">PHG4Parameters::get_int_param</a></div><div class="ttdeci">int get_int_param(const std::string &amp;name) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dab/PHG4Parameters_8cc_source.html#l00060">PHG4Parameters.cc:60</a></div></div>
<div class="ttc" id="getClass_8h_html"><div class="ttname"><a href="../../dd/dd4/getClass_8h.html">getClass.h</a></div></div>
<div class="ttc" id="classPHG4ParametersContainer_html_a6973acac6fe3b7d6ffaa7afe9d6c53c3"><div class="ttname"><a href="../../d5/d5f/classPHG4ParametersContainer.html#a6973acac6fe3b7d6ffaa7afe9d6c53c3">PHG4ParametersContainer::ConstRange</a></div><div class="ttdeci">std::pair&lt; ConstIterator, ConstIterator &gt; ConstRange</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d60/PHG4ParametersContainer_8h_source.html#l00022">PHG4ParametersContainer.h:22</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a5434387b570a7a774e33c9e34337f026"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a5434387b570a7a774e33c9e34337f026">PHG4SiliconTrackerSteppingAction::hit</a></div><div class="ttdeci">PHG4Hit * hit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00030">PHG4SiliconTrackerSteppingAction.h:30</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a9ba2e371a3dc60dc8ff6f365e22d787e"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9ba2e371a3dc60dc8ff6f365e22d787e">PHG4SiliconTrackerSteppingAction::IsBlackHole</a></div><div class="ttdeci">std::map&lt; int, int &gt; IsBlackHole</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00040">PHG4SiliconTrackerSteppingAction.h:40</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a299edb9d0b140d0456f8bfecdf9cac56"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a299edb9d0b140d0456f8bfecdf9cac56">PHG4Hit::get_edep</a></div><div class="ttdeci">virtual float get_edep() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00031">PHG4Hit.h:31</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a3a103b9cc928011c79a771379b39d1a3"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a3a103b9cc928011c79a771379b39d1a3">PHG4SiliconTrackerSteppingAction::savehitcontainer</a></div><div class="ttdeci">PHG4HitContainer * savehitcontainer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00031">PHG4SiliconTrackerSteppingAction.h:31</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a4a43f908a903bf247ea5ede08bd4f779"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4a43f908a903bf247ea5ede08bd4f779">PHG4SiliconTrackerSteppingAction::strip_z</a></div><div class="ttdeci">double strip_z[4][2]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00036">PHG4SiliconTrackerSteppingAction.h:36</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerDetector_html_a5dad9b731175d64532b856bb396f8976"><div class="ttname"><a href="../../dd/d34/classPHG4SiliconTrackerDetector.html#a5dad9b731175d64532b856bb396f8976">PHG4SiliconTrackerDetector::SuperDetector</a></div><div class="ttdeci">void SuperDetector(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7f/PHG4SiliconTrackerDetector_8h_source.html#l00039">PHG4SiliconTrackerDetector.h:39</a></div></div>
<div class="ttc" id="classPHCompositeNode_html"><div class="ttname"><a href="../../d5/dca/classPHCompositeNode.html">PHCompositeNode</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/PHCompositeNode_8h_source.html#l00014">PHCompositeNode.h:14</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_af9dee22834fd99b364dc8df7bcc18cfb"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#af9dee22834fd99b364dc8df7bcc18cfb">PHG4SiliconTrackerSteppingAction::~PHG4SiliconTrackerSteppingAction</a></div><div class="ttdeci">virtual ~PHG4SiliconTrackerSteppingAction()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc_source.html#l00081">PHG4SiliconTrackerSteppingAction.cc:81</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a78ab0be86e7135aa7eaee8f101bfdf33"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a78ab0be86e7135aa7eaee8f101bfdf33">PHG4SiliconTrackerSteppingAction::nstrips_phi_cell</a></div><div class="ttdeci">int nstrips_phi_cell[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00038">PHG4SiliconTrackerSteppingAction.h:38</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a3ab7971f354374b005f9a11fd761b53e"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a3ab7971f354374b005f9a11fd761b53e">PHG4Hit::set_y</a></div><div class="ttdeci">virtual void set_y(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00053">PHG4Hit.h:53</a></div></div>
<div class="ttc" id="PHG4ParametersContainer_8h_html"><div class="ttname"><a href="../../d4/d60/PHG4ParametersContainer_8h.html">PHG4ParametersContainer.h</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a5c93815f1d3921153ac87c5ff0c8439d"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a5c93815f1d3921153ac87c5ff0c8439d">PHG4Hit::set_py</a></div><div class="ttdeci">virtual void set_py(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00056">PHG4Hit.h:56</a></div></div>
<div class="ttc" id="PHG4Hit_8h_html"><div class="ttname"><a href="../../de/d83/PHG4Hit_8h.html">PHG4Hit.h</a></div></div>
<div class="ttc" id="PHG4SiliconTrackerSteppingAction_8h_html"><div class="ttname"><a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h.html">PHG4SiliconTrackerSteppingAction.h</a></div></div>
<div class="ttc" id="classPHG4Hit_html_ab8db2cb7bc978a58777600b2bd7a22ac"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#ab8db2cb7bc978a58777600b2bd7a22ac">PHG4Hit::get_eion</a></div><div class="ttdeci">virtual float get_eion() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00032">PHG4Hit.h:32</a></div></div>
<div class="ttc" id="classPHG4Shower_html_aff36d66ca2bfafcb3528d98960fb89c4"><div class="ttname"><a href="../../db/d88/classPHG4Shower.html#aff36d66ca2bfafcb3528d98960fb89c4">PHG4Shower::add_g4hit_id</a></div><div class="ttdeci">virtual void add_g4hit_id(int volume, PHG4HitDefs::keytype id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc0/PHG4Shower_8h_source.html#l00100">PHG4Shower.h:100</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a762aa9813238c4beb27178f73a7b864a"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a762aa9813238c4beb27178f73a7b864a">PHG4Hit::set_strip_z_index</a></div><div class="ttdeci">virtual void set_strip_z_index(const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00072">PHG4Hit.h:72</a></div></div>
<div class="ttc" id="classPHG4Hit_html_acde0bddc67695b3afde72fbc86a5d02f"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#acde0bddc67695b3afde72fbc86a5d02f">PHG4Hit::print</a></div><div class="ttdeci">virtual void print() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00087">PHG4Hit.h:87</a></div></div>
<div class="ttc" id="PHG4Shower_8h_html"><div class="ttname"><a href="../../d1/dc0/PHG4Shower_8h.html">PHG4Shower.h</a></div></div>
<div class="ttc" id="classPHG4Hit_html_aa91398b4546e9d099443217e1577f79b"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#aa91398b4546e9d099443217e1577f79b">PHG4Hit::set_x</a></div><div class="ttdeci">virtual void set_x(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00052">PHG4Hit.h:52</a></div></div>
<div class="ttc" id="classPHG4Hit_html_ad97bbe7fcf81822a93654afe0e540143"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#ad97bbe7fcf81822a93654afe0e540143">PHG4Hit::set_edep</a></div><div class="ttdeci">virtual void set_edep(const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00062">PHG4Hit.h:62</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a4eb4685a2f5238d32d29bfcfd4ab8acb"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a4eb4685a2f5238d32d29bfcfd4ab8acb">PHG4SiliconTrackerSteppingAction::absorberhits_</a></div><div class="ttdeci">PHG4HitContainer * absorberhits_</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00029">PHG4SiliconTrackerSteppingAction.h:29</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a9e5eb2d118770d0838c6dc49ef8e1a7c"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a9e5eb2d118770d0838c6dc49ef8e1a7c">PHG4SiliconTrackerSteppingAction::detector_</a></div><div class="ttdeci">PHG4SiliconTrackerDetector * detector_</div><div class="ttdoc">pointer to the detector </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00025">PHG4SiliconTrackerSteppingAction.h:25</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerDetector_html_a24cbf9b02cb6e7b73d8ab9ddb10f780a"><div class="ttname"><a href="../../dd/d34/classPHG4SiliconTrackerDetector.html#a24cbf9b02cb6e7b73d8ab9ddb10f780a">PHG4SiliconTrackerDetector::IsInSiliconTracker</a></div><div class="ttdeci">int IsInSiliconTracker(G4VPhysicalVolume *) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d27/PHG4SiliconTrackerDetector_8cc_source.html#l00060">PHG4SiliconTrackerDetector.cc:60</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_ae7f6874abfc47dbfade3d158bfc0e111"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#ae7f6874abfc47dbfade3d158bfc0e111">PHG4SiliconTrackerSteppingAction::missingabsorbers</a></div><div class="ttdeci">std::set&lt; std::string &gt; missingabsorbers</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00042">PHG4SiliconTrackerSteppingAction.h:42</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a65d6d5bfd2a9e6fe2392fc57ac6c57d0"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a65d6d5bfd2a9e6fe2392fc57ac6c57d0">PHG4Hit::set_eion</a></div><div class="ttdeci">virtual void set_eion(const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00063">PHG4Hit.h:63</a></div></div>
<div class="ttc" id="classPHG4ParametersContainer_html"><div class="ttname"><a href="../../d5/d5f/classPHG4ParametersContainer.html">PHG4ParametersContainer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d60/PHG4ParametersContainer_8h_source.html#l00015">PHG4ParametersContainer.h:15</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a5fe95d18c4dbfee43494b9b926d1df02"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a5fe95d18c4dbfee43494b9b926d1df02">PHG4Hit::set_pz</a></div><div class="ttdeci">virtual void set_pz(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00057">PHG4Hit.h:57</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a164f860f2c74482d5d26c220f19be1f1"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a164f860f2c74482d5d26c220f19be1f1">PHG4Hit::set_layer</a></div><div class="ttdeci">virtual void set_layer(const unsigned int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00066">PHG4Hit.h:66</a></div></div>
<div class="ttc" id="PHG4StepStatusDecode_8h_html"><div class="ttname"><a href="../../db/df9/PHG4StepStatusDecode_8h.html">PHG4StepStatusDecode.h</a></div></div>
<div class="ttc" id="classPHG4SteppingAction_html_a88ff50956245a2b72d459bad2004e1ca"><div class="ttname"><a href="../../df/d3f/classPHG4SteppingAction.html#a88ff50956245a2b72d459bad2004e1ca">PHG4SteppingAction::GetName</a></div><div class="ttdeci">std::string GetName() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d55/PHG4SteppingAction_8h_source.html#l00053">PHG4SteppingAction.h:53</a></div></div>
<div class="ttc" id="classPHG4Detector_html_a2d071f49fa045db5ade51bb99f88218f"><div class="ttname"><a href="../../d3/de7/classPHG4Detector.html#a2d071f49fa045db5ade51bb99f88218f">PHG4Detector::GetName</a></div><div class="ttdeci">virtual std::string GetName() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/PHG4Detector_8h_source.html#l00051">PHG4Detector.h:51</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerDetector_html"><div class="ttname"><a href="../../dd/d34/classPHG4SiliconTrackerDetector.html">PHG4SiliconTrackerDetector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7f/PHG4SiliconTrackerDetector_8h_source.html#l00021">PHG4SiliconTrackerDetector.h:21</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_a304ef224802ddf9e7ce2e6255e4e49de"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#a304ef224802ddf9e7ce2e6255e4e49de">PHG4SiliconTrackerSteppingAction::IsActive</a></div><div class="ttdeci">std::map&lt; int, int &gt; IsActive</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00039">PHG4SiliconTrackerSteppingAction.h:39</a></div></div>
<div class="ttc" id="classPHG4Hitv1_html"><div class="ttname"><a href="../../d9/d35/classPHG4Hitv1.html">PHG4Hitv1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2b/PHG4Hitv1_8h_source.html#l00015">PHG4Hitv1.h:15</a></div></div>
<div class="ttc" id="classPHG4Hit_html_a896d7a45139f9cbc2e429127baa61715"><div class="ttname"><a href="../../d3/d9e/classPHG4Hit.html#a896d7a45139f9cbc2e429127baa61715">PHG4Hit::set_z</a></div><div class="ttdeci">virtual void set_z(const int i, const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d83/PHG4Hit_8h_source.html#l00054">PHG4Hit.h:54</a></div></div>
<div class="ttc" id="classPHG4HitContainer_html_a4df3ca68ecff69c9d7976b84fcc82e93"><div class="ttname"><a href="../../d4/d30/classPHG4HitContainer.html#a4df3ca68ecff69c9d7976b84fcc82e93">PHG4HitContainer::AddHit</a></div><div class="ttdeci">ConstIterator AddHit(PHG4Hit *newhit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d4c/PHG4HitContainer_8cc_source.html#l00107">PHG4HitContainer.cc:107</a></div></div>
<div class="ttc" id="PHG4HitContainer_8h_html"><div class="ttname"><a href="../../d3/d08/PHG4HitContainer_8h.html">PHG4HitContainer.h</a></div></div>
<div class="ttc" id="classPHG4SiliconTrackerSteppingAction_html_afc148f1d3758eb5277136f87f189fe72"><div class="ttname"><a href="../../d3/d83/classPHG4SiliconTrackerSteppingAction.html#afc148f1d3758eb5277136f87f189fe72">PHG4SiliconTrackerSteppingAction::saveshower</a></div><div class="ttdeci">PHG4Shower * saveshower</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d75/PHG4SiliconTrackerSteppingAction_8h_source.html#l00032">PHG4SiliconTrackerSteppingAction.h:32</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_36264afcc6c88fe4468b6a0e9b7ed3fa.html">seaquest-offline</a></li><li class="navelem"><a class="el" href="../../dir_c44bdef8d2c50542e2f1b63b16d5515c.html">simulation</a></li><li class="navelem"><a class="el" href="../../dir_e221857b5988de1ce69506dda9ffdb31.html">g4detectors</a></li><li class="navelem"><a class="el" href="../../d4/dda/PHG4SiliconTrackerSteppingAction_8cc.html">PHG4SiliconTrackerSteppingAction.cc</a></li>
		<li class="footer">
		Built by <a href="mailto:yuhw@nmsu.edu">Haiwang Yu</a></em>.
			updated: <em>Wed May 16 2018 15:20:52</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.6 
				with <a href="https://github.com/HaiwangYu/seaquest-offline">SeaQuest GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
